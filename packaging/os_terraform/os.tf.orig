variable "access_key" {}
variable "secret_key" {}
variable "os_tenant" {}

# Configure the Openstack Provider
provider "openstack" {
 user_name   = "${var.access_key}"
 tenant_name = "${var.os_tenant}"
 password    = "${var.secret_key}"
 auth_url    = "https://rackspace-api.gigaspaces.com:5000/v2.0/"
 region      = "RegionOne"
}

resource "openstack_compute_instance_v2" "centos_core_agent-test" {
 name = "centos_core_agent-test"
 image_name = "CentOS-7-x86_64-GenericCloud"
 flavor_name = "m1.medium"
 key_pair = "jenkins_slave"
 security_groups = ["os_jenkins_sec_group"]

 network {
   uuid = "b924a2d8-1e9e-49ad-b293-f0a1a37d33ad"
 }


 connection {
   type = "ssh"
   user = "centos"
   private_key = "/Users/mac/.ssh/os/jenkins_slave.pem"
   timeout = "10m"
   agent = "false"
 }
  }
